<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>C#操作Access数据库（vs2019）</title>
      <link href="/2023/01/08/C-%E6%93%8D%E4%BD%9CAccess%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88vs2019%EF%BC%89/"/>
      <url>/2023/01/08/C-%E6%93%8D%E4%BD%9CAccess%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88vs2019%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="一、数据库连接与编程实现"><a href="#一、数据库连接与编程实现" class="headerlink" title="一、数据库连接与编程实现"></a>一、数据库连接与编程实现</h1><h2 id="1、创建Access数据库"><a href="#1、创建Access数据库" class="headerlink" title="1、创建Access数据库"></a>1、创建Access数据库</h2><p>1）打开Office Access新建一个空白数据库DATA.accdb，并改好存放位置。<br>2）根据自己需要建立一个新表，命名为表1；并在表内添加自己需要的列表数据。<br>3）保存数据库，也可另存为.mdb格式。</p><h2 id="2-数据库与C-建立连接"><a href="#2-数据库与C-建立连接" class="headerlink" title="2.数据库与C#建立连接"></a>2.数据库与C#建立连接</h2><p>1）打开Visual Studio，点击菜单栏中的工具选项卡，然后点击连接到数据库条目，跳转到添加连接。<br><img src="https://s2.loli.net/2023/01/08/l8iwSXdmjo4eNRG.png" alt="在这里插入图片描述"></p><p>2）进行数据库中选择并测试链接是否成功。<br><img src="https://s2.loli.net/2023/01/08/Zr2NzViIWc8XtfL.png" alt="在这里插入图片描述"></p><p>3）点击高级，复制该行代码，后面用，依次点击确定退出。<br><img src="https://s2.loli.net/2023/01/08/spcItSCMTrh3HNJ.png" alt="在这里插入图片描述"></p><p>4）然后就可在服务器资源管理处看到导入的数据库。<br> <img src="https://s2.loli.net/2023/01/08/YefHxKiIn1CQEjU.png" alt="在这里插入图片描述"></p><h2 id="3-编程实现数据库的读取"><a href="#3-编程实现数据库的读取" class="headerlink" title="3.编程实现数据库的读取"></a>3.编程实现数据库的读取</h2><p>1）创建一个窗体应用项目，加入一个textbox、三个botton按键，以及和一个dataGridView窗口（具体位置在数据分类型下）。<br><img src="https://s2.loli.net/2023/01/08/bIUDf7VjdnPK1Sz.png" alt="在这里插入图片描述"></p><h2 id="2）代码部分"><a href="#2）代码部分" class="headerlink" title="2）代码部分"></a>2）代码部分</h2><p>引用：增加以下引用</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Data.OleDb;</span><br></pre></td></tr></table></figure><p>具体程序，Form类</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">FormDatabase</span> : <span class="title">Form</span></span><br><span class="line">   &#123;</span><br><span class="line">        <span class="comment">// 连接字符串</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">string</span> connStr = <span class="string">@&quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Users\10234\Desktop\DATA.accdb&quot;</span>;<span class="comment">//此处为前面复制出来的代码</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//声明</span></span><br><span class="line">        <span class="keyword">private</span> OleDbConnection conn = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> OleDbDataAdapter adapter = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> DataTable dt = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">FormDatabase</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 连接数据库，需要传递连接字符串</span></span><br><span class="line">            conn = <span class="keyword">new</span> OleDbConnection(connStr);</span><br><span class="line">            <span class="comment">// 打开数据库连接</span></span><br><span class="line">            conn.Open();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &quot;Select * from 表1&quot;为SQL语句，意思是从数据库中选择叫做“表1”的表，“conn”为连接</span></span><br><span class="line">            adapter = <span class="keyword">new</span> OleDbDataAdapter(<span class="string">&quot;Select * from 表1&quot;</span>, conn);</span><br><span class="line">            <span class="comment">// CommandBuilder对应的是数据适配器，需要传递参数</span></span><br><span class="line">            <span class="keyword">var</span> cmd = <span class="keyword">new</span> OleDbCommandBuilder(adapter);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 在内存中创建一个DataTable，用来存放、修改数据库表</span></span><br><span class="line">            dt = <span class="keyword">new</span> DataTable();</span><br><span class="line">            <span class="comment">// 通过适配器把表的数据填充到内存dt</span></span><br><span class="line">            adapter.Fill(dt);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 把数据显示到界面</span></span><br><span class="line">            dataGridView1.DataSource = dt.DefaultView;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button2_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 按下按钮后，把内存中修改的部分传递给适配器，再通过适配器传递给数据库</span></span><br><span class="line">                adapter.Update(dt);</span><br><span class="line">                <span class="comment">// 清除内存中存放的表数据</span></span><br><span class="line">                dt.Clear();</span><br><span class="line">                <span class="comment">// 重新读取已经改变过的表数据</span></span><br><span class="line">                adapter.Fill(dt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(ex.Message);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button3_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> sql = textBox1.Text;</span><br><span class="line">            OleDbCommand comm = <span class="keyword">new</span> OleDbCommand(sql, conn);</span><br><span class="line">            comm.ExecuteNonQuery();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FormDatabase_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            textBox1.Text = <span class="string">&quot;insert into 表1(工作时间,工作机位,摄像头编号,IP地址)values(2009/12/31,2,3,4)&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="二、数据库的操作"><a href="#二、数据库的操作" class="headerlink" title="二、数据库的操作"></a>二、数据库的操作</h1><p>输入的String指令为SQL语言，具体语法格式参考SQL语言规范即可</p><h2 id="1、在数据库某一表中增加一行数据。"><a href="#1、在数据库某一表中增加一行数据。" class="headerlink" title="1、在数据库某一表中增加一行数据。"></a>1、在数据库某一表中增加一行数据。</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> sql = <span class="string">&quot;insert into 表名(字段1，字段2，…)values(数据1，数据2，…)&quot;</span>; </span><br><span class="line"><span class="comment">//字段指的是数据表的表头名，数据1为对应字段加入的数据，默认为double类型。</span></span><br><span class="line">OleDbCommand comm = <span class="keyword">new</span> OleDbCommand(sql, conn);</span><br><span class="line"><span class="comment">//cnn为前面读取的数据表名</span></span><br><span class="line">comm.ExecuteNonQuery();</span><br></pre></td></tr></table></figure><h2 id="2、修改某一个数据的值"><a href="#2、修改某一个数据的值" class="headerlink" title="2、修改某一个数据的值"></a>2、修改某一个数据的值</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> sql = <span class="string">&quot; update 表名 set 字段a = 222 where 字段b = 19&quot;</span>; </span><br><span class="line"><span class="comment">//字段a指的是要修改的数据表头名，数据b为要修改数据对应的改行其他数据表头名，通过字段b对应的数据确定字段a所在的位置。</span></span><br><span class="line">OleDbCommand comm = <span class="keyword">new</span> OleDbCommand(sql, conn);</span><br><span class="line"><span class="comment">//cnn为前面读取的数据表名</span></span><br><span class="line">comm.ExecuteNonQuery();</span><br></pre></td></tr></table></figure><h2 id="3-查找数据表中某一字段中的数据对应的那一行数据"><a href="#3-查找数据表中某一字段中的数据对应的那一行数据" class="headerlink" title="3.查找数据表中某一字段中的数据对应的那一行数据"></a>3.查找数据表中某一字段中的数据对应的那一行数据</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">         OleDbDataAdapter oleDapAdapter; <span class="comment">//检索与填充数据，一般填充SQL语句  </span></span><br><span class="line">         DataSet ds = <span class="keyword">new</span> DataSet();     <span class="comment">//填充ds，保存数据 </span></span><br><span class="line"><span class="built_in">string</span> sql = <span class="string">&quot;select * from 表1 where ID = 18&quot;</span>;</span><br><span class="line"><span class="comment">// select 列名称 from 表名 where 限定的数据表条件</span></span><br><span class="line"><span class="comment">//列名称可用*代替全部；</span></span><br><span class="line">         oleDapAdapter = <span class="keyword">new</span> OleDbDataAdapter(sql, conn);</span><br><span class="line">         oleDapAdapter.Fill(ds);<span class="comment">//将查到的数据放到数据表ds中；</span></span><br><span class="line">         <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; ds.Tables[<span class="number">0</span>].Rows.Count; i++)</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; ds.Tables[<span class="number">0</span>].Columns.Count; j++)</span><br><span class="line">             &#123;</span><br><span class="line">                 MessageBox.Show(ds.Tables[<span class="number">0</span>].Rows[i][j].ToString());<span class="comment">//需要转成String类型  </span></span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         ds.Reset();</span><br></pre></td></tr></table></figure><h2 id="4-在数据库中创建新表"><a href="#4-在数据库中创建新表" class="headerlink" title="4.在数据库中创建新表"></a>4.在数据库中创建新表</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> dbstr = <span class="string">&quot;CREATE TABLE 表2(ID INT,文件夹位置 char(255),文件名字 char(255))&quot;</span>;</span><br><span class="line"><span class="comment">// CREATE TABLE 表名(ID INT,文件夹位置 char(255),文件名字 char(255))</span></span><br><span class="line">            OleDbCommand oleDbCom = <span class="keyword">new</span> OleDbCommand(dbstr, conn);</span><br><span class="line">            oleDbCom.ExecuteNonQuery();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C# </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
            <tag> Acess数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/01/06/hello-world/"/>
      <url>/2023/01/06/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
