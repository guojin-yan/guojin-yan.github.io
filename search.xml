<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>OpenVINO_2022_安装教程</title>
      <link href="/2023/01/26/OpenVINO-2022-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
      <url>/2023/01/26/OpenVINO-2022-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h2 id="更新日志"><a href="#更新日志" class="headerlink" title="更新日志"></a>更新日志</h2><ul><li><p><strong>2023.1.26 更新</strong></p><ul><li>更新  OpenVINO<sup>TM </sup> 2022.1更新2022.3教程</li></ul></li><li><p><strong>2022.9.24 更新</strong></p><ul><li>更新  OpenVINO<sup>TM </sup> 2022.1更新2022.2教程</li></ul></li><li><p><strong>2022.9.19 更新</strong></p><ul><li>创建安装文档；</li><li>更新 OpenVINOTM<sup>TM</sup> 2022.1 runtime time以及完整版安装教程</li></ul></li></ul><h2 id="1-OpenVINOTMTM-安装环境和安装特性介绍"><a href="#1-OpenVINOTMTM-安装环境和安装特性介绍" class="headerlink" title="1. OpenVINOTMTM 安装环境和安装特性介绍"></a>1. OpenVINOTM<sup>TM</sup> 安装环境和安装特性介绍</h2><h3 id="1-1-OpenVINOTMTM-安装环境"><a href="#1-1-OpenVINOTMTM-安装环境" class="headerlink" title="1.1 OpenVINOTMTM 安装环境"></a>1.1 OpenVINOTM<sup>TM</sup> 安装环境</h3><p>&amp;emsp;OpenVINOTM<sup>TM</sup> 是一款依赖计算机或智能设备硬件的模型推理部署套件，在边缘启用基于 CNN 的深度学习推理，支持跨英特尔<sup>®</sup> CPU、英特尔® 集成显卡、英特尔<sup>®</sup> 神经计算棒 2 和英特尔<sup>®</sup>  视觉加速器设计与英特尔<sup>®</sup>  Movidius<sup>TM</sup> VPU 的异构执行。此处我们介绍在Windows平台上的安装和使用。</p><p>&amp;emsp;由于OpenVINOTM<sup>TM</sup> 是一款依赖计算机或智能设备硬件的模型推理部署套件，因此它可以在自家的设备上很好的运行，经过测试，在Windows平台上，非 intel CPU设备也可以运行OpenVINOTM<sup>TM</sup>，例如AMD推出的CPU，此处安装使用的设备为AMD R7-5800H；对于显卡设备不支持英伟达等其他显卡，仅支持英特尔自家显卡。</p><ul><li><p>CPU：AMD R7-5800H</p></li><li><p>GPU：NVIDIA GeForce RTX 3060 Laptop GPU 6G</p></li><li><p>操作系统：Windows 11</p></li><li><p>虚拟环境：Anaconda Navigator (anconda3)</p></li><li><p>C++编译环境：Visual Studio 2022</p></li><li><p>Python编译环境：Python 3.9</p></li></ul><h3 id="1-2-OpenVINOTMTM-安装特性"><a href="#1-2-OpenVINOTMTM-安装特性" class="headerlink" title="1.2 OpenVINOTMTM 安装特性"></a>1.2 OpenVINOTM<sup>TM</sup> 安装特性</h3><p>&amp;emsp;OpenVINO<sup>TM</sup>最新版本为2022.1版本， OpenVINO<sup>TM</sup>安装分为完整版安装与不完整版(Runtime)安装。</p><p>&amp;emsp;完整版安装会安装所有部件，包括模型优化器和推理部署套件运行工具(Runtime)，目前该方式支持PIP安装方式，因此建议采用PIP安装在虚拟环境中，防止安装出错照成电脑环境出现问题。该安装方式至此Python、C++同时使用，由于安装路径较长，对C++使用不太方便，因此该安装方式最好使用Python编程。</p><p>&amp;emsp;非完整版安装主要安装编译环境(Runtime)，安装比较简单，且一般会安装到根目录下，方便使用，因此如果不使用模型优化且情况下，或者使用C++编译环境的话，建议选用此方式。</p><h2 id="2-OpenVINOTMTM-Runtime安装"><a href="#2-OpenVINOTMTM-Runtime安装" class="headerlink" title="2.OpenVINOTMTM  Runtime安装"></a>2.OpenVINOTM<sup>TM</sup>  Runtime安装</h2><h3 id="2-1-下载安装包"><a href="#2-1-下载安装包" class="headerlink" title="2.1 下载安装包"></a>2.1 下载安装包</h3><p>&amp;emsp;OpenVINOTM<sup>TM</sup> 官方网站为<code>openvino.ai</code>或者直接访问<a href="https://www.intel.com/content/www/us/en/developer/tools/openvino-toolkit/overview.html">Intel® Distribution of OpenVINO™ Toolkit</a>网站，进入后点击<code>Free Douwnload</code>，进入下载页面。</p><p><img src="https://s2.loli.net/2023/01/26/9xYq2A53Rmsc6TX.png" alt="image-20220919193047292"></p><p>&amp;emsp;选择安装依赖，依次选择<code>Runtime</code>、<code>Windows</code>、<code>2022.1</code>、<code>C++</code>、<code>Offline Installer</code>安装选择，最后选择<code>Download</code>，下载安装包。根据OpenVINOTM<sup>TM</sup>  更新，当前页面可能会发生变化。</p><p><img src="https://s2.loli.net/2023/01/26/xF6KjMBNb15yqrC.png" alt="image-20220919193655398"></p><p>&amp;emsp;下载完为以下的安装文件。</p><p><img src="https://s2.loli.net/2023/01/26/f3jbTJMYwWq98eG.png" alt="image-20220919200938500"></p><h3 id="2-2-软件安装"><a href="#2-2-软件安装" class="headerlink" title="2.2 软件安装"></a>2.2 软件安装</h3><p>&amp;emsp;（1）双击打开安装文件，首先会提示一个安装文件解压，随便新建一个位置，只能装后会及时删除。</p><p><img src="https://s2.loli.net/2023/01/26/CFuDmnhTI4RBwav.png" alt="1"></p><p>&amp;emsp;（2）解压完成后会自动弹出安装页面，如下图所示，点击<code>continue</code></p><p><img src="https://s2.loli.net/2023/01/26/LuwiVM3Z4UXaOKJ.png" alt="3"></p><p>&amp;emsp;（3）Summary中展示的是安装的硬件要求以及安装位置，安装硬件环境无需考虑；安装位置此处不可以修改，将其安装到指定位置，方便后面的使用。选择解释许可协议，选择<code>Recommended Installation</code>安装方式。</p><p><img src="https://s2.loli.net/2023/01/26/DHcZavXt7FErwYS.png" alt="4"></p><p>&amp;emsp;（4）选择接收相关信息，点击<code>Install</code>，进行安装。</p><p><img src="https://s2.loli.net/2023/01/26/8EWQHpTdowIG9yt.png" alt="5"></p><p>&amp;emsp;（5）此处会提示几个警告，不用管，可以保存截图后续安装。</p><p>&amp;emsp;第一条和第三条是CPU和GPU，无需考虑；第二个为C++编译器，在编译自带的源码时会使用，使用Visual Studio 2019和Visual Studio 2022都可以。</p><p><img src="https://s2.loli.net/2023/01/26/8IVuT1ksiCL6NJQ.png" alt="6"></p><p>&amp;emsp;（6）安装后点击关闭即可</p><p><img src="https://s2.loli.net/2023/01/26/6txgseDzBZLb1Er.png" alt="7"></p><p>&amp;emsp;（7）安装完成后会出现以下文件</p><p><img src="https://s2.loli.net/2023/01/26/gPndiTfUN74Wz9w.png" alt="9"></p><h3 id="2-3-添加环境变量"><a href="#2-3-添加环境变量" class="headerlink" title="2.3 添加环境变量"></a>2.3 添加环境变量</h3><p>&amp;emsp;在系统环境变量中，增加以下三个环境变量。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Intel\openvino_2022.1.0.643\runtime\3rdparty\tbb\bin</span><br><span class="line">C:\Program Files (x86)\Intel\openvino_2022.1.0.643\runtime\bin\intel64\Release</span><br><span class="line">C:\Program Files (x86)\Intel\openvino_2022.1.0.643\runtime\bin\intel64\Debug</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/01/26/zpi4b6SYKvVkfNA.png" alt="image-20220919202633500"></p><h2 id="3-OpenVINOTMTM完整版安装"><a href="#3-OpenVINOTMTM完整版安装" class="headerlink" title="3. OpenVINOTMTM完整版安装"></a>3. OpenVINOTM<sup>TM</sup>完整版安装</h2><p>&amp;emsp;完整版安装需要许多依赖项，我们此处采用虚拟环境安装。</p><h3 id="3-1-创建虚拟环境"><a href="#3-1-创建虚拟环境" class="headerlink" title="3.1 创建虚拟环境"></a>3.1 创建虚拟环境</h3><p>&amp;emsp;在Anaconda 3 中创建一个虚拟环境，命名为<code>openvino2022_1</code>，并打开环境的命令窗口</p><p><img src="https://s2.loli.net/2023/01/26/wIg2V9FCvh7ikQj.png" alt="image-20220919202935803"></p><p><img src="https://s2.loli.net/2023/01/26/ViwtolpeG6mbOck.png" alt="image-20220919203427329"></p><h3 id="3-2-安装命令"><a href="#3-2-安装命令" class="headerlink" title="3.2 安装命令"></a>3.2 安装命令</h3><p>&amp;emsp;在OpenVINO<sup>TM</sup>页面，依次选择<code>Dev Tools</code>、<code>Windows</code>、<code>2022.1</code>、<code>PIP</code>、<code>ONNX</code>(深度学习框架，可以按照需求选择)，最后复制下面的安装命令到我们的虚拟环境的命令窗口，进行安装。</p><p><img src="https://s2.loli.net/2023/01/26/NMuz3FJHBavRIUs.png" alt="image-20220919203257668"></p><p><img src="https://s2.loli.net/2023/01/26/C7mYoRIUyQjPHLh.png" alt="image-20220919203710772"></p><p>&amp;emsp;输入命令后，会根据安装要求，自动下载并安装到虚拟环境中。</p><p><img src="https://s2.loli.net/2023/01/26/hZIgtkvN1WQKEyM.png" alt="image-20220919203933874"></p><p>&amp;emsp;安装时间会比较长，且有可能因为网速问题安装失败，如果失败就重新输入上述命令进行安装。</p><p>&amp;emsp;安装结束后如下图所示。</p><p><img src="https://s2.loli.net/2023/01/26/dtJuKY8mscUwanx.png" alt="image-20220919210854124"></p><h2 id="4-OpenVINOTM-2022-1更新2022-2教程"><a href="#4-OpenVINOTM-2022-1更新2022-2教程" class="headerlink" title="4. OpenVINOTM  2022.1更新2022.2教程"></a>4. OpenVINO<sup>TM </sup> 2022.1更新2022.2教程</h2><p>&amp;emsp;OpenVINO<sup>TM</sup> 工具套件2022.1版于2022年3月22日正式发布，与以往版本相比发生了重大革新，提供预处理API函数、ONNX前端API、AUTO 设备插件，并且支持直接读入飞桨模型，在推理中中支持动态改变模型的形状，这极大地推动了不同网络的应用落地。</p><p>&amp;emsp;2022年9月23日，OpenVINO<sup>TM</sup> 工具套件2022.2版推出，对2022.1进行了微调，以包括对英特尔最新 CPU 和离散 GPU 的支持，以实现更多的人工智能创新和机会。</p><p>&amp;emsp;由于2022.2版同属2022系列，除了增加对英特尔最新 CPU 和离散 GPU 的支持，其他API函数没有发生变化，因此我们可以直接对其进行更新，这样不会影响我们的以前的项目使用。</p><p>&amp;emsp;如果2022.1版大家选择的Runtime C++本地安装，这里推荐给大家一个简单的升级办法，无需卸载原有版本，可以实现两个版本共存。</p><h3 id="4-1-新版文件下载与设置"><a href="#4-1-新版文件下载与设置" class="headerlink" title="4.1  新版文件下载与设置"></a>4.1  新版文件下载与设置</h3><p>&amp;emsp;首先进入<a href="https://storage.openvinotoolkit.org/repositories/openvino/packages/2022.2/windows/">storage.openvinotoolkit.org</a>网站，下载最新版的Cmake后的文件：</p><p><img src="https://s2.loli.net/2023/01/26/zEFmi2WLrMOGwoP.png" alt="image-20230126160448463"></p><p>&amp;emsp;按照自己的系统下载自己需要的文件。文件下载好后解压该文件，并将该文件夹修改名为<code>openvino_2022.2.0.7713</code>，最后将文件夹拷贝到下面路径中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Intel</span><br></pre></td></tr></table></figure><p>&amp;emsp;该路径为Openvino2022.1安装的路径</p><p><img src="https://s2.loli.net/2023/01/26/fu2oaNyHevI85z6.png" alt="image-20220924102036288"></p><h3 id="4-2-配置环境变量"><a href="#4-2-配置环境变量" class="headerlink" title="4.2 配置环境变量"></a>4.2 配置环境变量</h3><p>&amp;emsp;在系统环境变量下，增加新的版本路径：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Intel\openvino_2022.2.0.7713\runtime\bin\intel64\Debug</span><br><span class="line">C:\Program Files (x86)\Intel\openvino_2022.2.0.7713\runtime\bin\intel64\Release</span><br><span class="line">C:\Program Files (x86)\Intel\openvino_2022.2.0.7713\runtime\3rdparty\tbb\bin</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/01/26/oPeuSwjNyGnZ4pH.png" alt="image-20220924102410848"></p><p>&amp;emsp;完成以上步骤，2022.2版OpenVINO<sup>TM</sup>就可以使用了。</p><h2 id="5-OpenVINOTM-2022-1更新2022-3教程"><a href="#5-OpenVINOTM-2022-1更新2022-3教程" class="headerlink" title="5. OpenVINOTM  2022.1更新2022.3教程"></a>5. OpenVINO<sup>TM </sup> 2022.1更新2022.3教程</h2><h3 id="5-1-新版文件下载与设置"><a href="#5-1-新版文件下载与设置" class="headerlink" title="5.1  新版文件下载与设置"></a>5.1  新版文件下载与设置</h3><p>&amp;emsp;首先进入<a href="https://www.intel.com/content/www/us/en/developer/tools/openvino-toolkit/download.html">Download Intel® Distribution of OpenVINO™ Toolkit</a>网站，下载最新版的文件。</p><p>&amp;emsp;选择安装依赖，依次选择<code>Runtime</code>、<code>Windows</code>、<code>2022.1</code>、<code>C++</code>、<code>OpenVINO Archives</code>安装选择，最后选择<code>Download Archives</code>，下载安装包。根据OpenVINOTM<sup>TM</sup>  更新，当前页面可能会发生变化。</p><p><img src="https://s2.loli.net/2023/01/26/dUP48mCGOyND5cx.png" alt="image-20230126160953995"></p><p>&amp;emsp;进入以下页面后，点击最新版安装包进行下载。</p><p><img src="https://s2.loli.net/2023/01/26/fS3tYZqiDAJXoK2.png" alt="image-20230126161144925"></p><p>&amp;emsp;按照自己的系统下载自己需要的文件。文件下载好后解压该文件，并将该文件夹修改名为<code>openvino_openvino_2022.3.0.9052</code>，最后将文件夹拷贝到下面路径中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Intel</span><br></pre></td></tr></table></figure><p>&amp;emsp;该路径为Openvino2022.1安装的路径</p><p><img src="https://s2.loli.net/2023/01/26/pbLxHDTjC8udAyX.png" alt="image-20230126161442229"></p><h3 id="4-2-配置环境变量-1"><a href="#4-2-配置环境变量-1" class="headerlink" title="4.2 配置环境变量"></a>4.2 配置环境变量</h3><p>&amp;emsp;在系统环境变量下，增加新的版本路径：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Intel\openvino_2022.3.0.9052\runtime\bin\intel64\Debug</span><br><span class="line">C:\Program Files (x86)\Intel\openvino_2022.3.0.9052\runtime\bin\intel64\Release</span><br><span class="line">C:\Program Files (x86)\Intel\openvino_2022.3.0.9052\runtime\3rdparty\tbb\bin</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/01/26/4N6uXR2yrPTamkY.png" alt="image-20230126161600124"></p><p>&amp;emsp;完成以上步骤，2022.3版OpenVINO<sup>TM</sup>就可以使用了。</p>]]></content>
      
      
      <categories>
          
          <category> OpenVINO </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> OpenVINO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C#操作Access数据库（vs2019）</title>
      <link href="/2023/01/08/C-%E6%93%8D%E4%BD%9CAccess%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88vs2019%EF%BC%89/"/>
      <url>/2023/01/08/C-%E6%93%8D%E4%BD%9CAccess%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88vs2019%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="一、数据库连接与编程实现"><a href="#一、数据库连接与编程实现" class="headerlink" title="一、数据库连接与编程实现"></a>一、数据库连接与编程实现</h1><h2 id="1、创建Access数据库"><a href="#1、创建Access数据库" class="headerlink" title="1、创建Access数据库"></a>1、创建Access数据库</h2><p>1）打开Office Access新建一个空白数据库DATA.accdb，并改好存放位置。<br>2）根据自己需要建立一个新表，命名为表1；并在表内添加自己需要的列表数据。<br>3）保存数据库，也可另存为.mdb格式。</p><h2 id="2-数据库与C-建立连接"><a href="#2-数据库与C-建立连接" class="headerlink" title="2.数据库与C#建立连接"></a>2.数据库与C#建立连接</h2><p>1）打开Visual Studio，点击菜单栏中的工具选项卡，然后点击连接到数据库条目，跳转到添加连接。<br><img src="https://s2.loli.net/2023/01/08/l8iwSXdmjo4eNRG.png" alt="在这里插入图片描述"></p><p>2）进行数据库中选择并测试链接是否成功。<br><img src="https://s2.loli.net/2023/01/08/Zr2NzViIWc8XtfL.png" alt="在这里插入图片描述"></p><p>3）点击高级，复制该行代码，后面用，依次点击确定退出。<br><img src="https://s2.loli.net/2023/01/08/spcItSCMTrh3HNJ.png" alt="在这里插入图片描述"></p><p>4）然后就可在服务器资源管理处看到导入的数据库。<br> <img src="https://s2.loli.net/2023/01/08/YefHxKiIn1CQEjU.png" alt="在这里插入图片描述"></p><h2 id="3-编程实现数据库的读取"><a href="#3-编程实现数据库的读取" class="headerlink" title="3.编程实现数据库的读取"></a>3.编程实现数据库的读取</h2><p>1）创建一个窗体应用项目，加入一个textbox、三个botton按键，以及和一个dataGridView窗口（具体位置在数据分类型下）。<br><img src="https://s2.loli.net/2023/01/08/bIUDf7VjdnPK1Sz.png" alt="在这里插入图片描述"></p><h2 id="2）代码部分"><a href="#2）代码部分" class="headerlink" title="2）代码部分"></a>2）代码部分</h2><p>引用：增加以下引用</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Data.OleDb;</span><br></pre></td></tr></table></figure><p>具体程序，Form类</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">FormDatabase</span> : <span class="title">Form</span></span><br><span class="line">   &#123;</span><br><span class="line">        <span class="comment">// 连接字符串</span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">string</span> connStr = <span class="string">@&quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Users\10234\Desktop\DATA.accdb&quot;</span>;<span class="comment">//此处为前面复制出来的代码</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//声明</span></span><br><span class="line">        <span class="keyword">private</span> OleDbConnection conn = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> OleDbDataAdapter adapter = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">private</span> DataTable dt = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">FormDatabase</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 连接数据库，需要传递连接字符串</span></span><br><span class="line">            conn = <span class="keyword">new</span> OleDbConnection(connStr);</span><br><span class="line">            <span class="comment">// 打开数据库连接</span></span><br><span class="line">            conn.Open();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &quot;Select * from 表1&quot;为SQL语句，意思是从数据库中选择叫做“表1”的表，“conn”为连接</span></span><br><span class="line">            adapter = <span class="keyword">new</span> OleDbDataAdapter(<span class="string">&quot;Select * from 表1&quot;</span>, conn);</span><br><span class="line">            <span class="comment">// CommandBuilder对应的是数据适配器，需要传递参数</span></span><br><span class="line">            <span class="keyword">var</span> cmd = <span class="keyword">new</span> OleDbCommandBuilder(adapter);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 在内存中创建一个DataTable，用来存放、修改数据库表</span></span><br><span class="line">            dt = <span class="keyword">new</span> DataTable();</span><br><span class="line">            <span class="comment">// 通过适配器把表的数据填充到内存dt</span></span><br><span class="line">            adapter.Fill(dt);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 把数据显示到界面</span></span><br><span class="line">            dataGridView1.DataSource = dt.DefaultView;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button2_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 按下按钮后，把内存中修改的部分传递给适配器，再通过适配器传递给数据库</span></span><br><span class="line">                adapter.Update(dt);</span><br><span class="line">                <span class="comment">// 清除内存中存放的表数据</span></span><br><span class="line">                dt.Clear();</span><br><span class="line">                <span class="comment">// 重新读取已经改变过的表数据</span></span><br><span class="line">                adapter.Fill(dt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(ex.Message);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button3_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> sql = textBox1.Text;</span><br><span class="line">            OleDbCommand comm = <span class="keyword">new</span> OleDbCommand(sql, conn);</span><br><span class="line">            comm.ExecuteNonQuery();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FormDatabase_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            textBox1.Text = <span class="string">&quot;insert into 表1(工作时间,工作机位,摄像头编号,IP地址)values(2009/12/31,2,3,4)&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="二、数据库的操作"><a href="#二、数据库的操作" class="headerlink" title="二、数据库的操作"></a>二、数据库的操作</h1><p>输入的String指令为SQL语言，具体语法格式参考SQL语言规范即可</p><h2 id="1、在数据库某一表中增加一行数据。"><a href="#1、在数据库某一表中增加一行数据。" class="headerlink" title="1、在数据库某一表中增加一行数据。"></a>1、在数据库某一表中增加一行数据。</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> sql = <span class="string">&quot;insert into 表名(字段1，字段2，…)values(数据1，数据2，…)&quot;</span>; </span><br><span class="line"><span class="comment">//字段指的是数据表的表头名，数据1为对应字段加入的数据，默认为double类型。</span></span><br><span class="line">OleDbCommand comm = <span class="keyword">new</span> OleDbCommand(sql, conn);</span><br><span class="line"><span class="comment">//cnn为前面读取的数据表名</span></span><br><span class="line">comm.ExecuteNonQuery();</span><br></pre></td></tr></table></figure><h2 id="2、修改某一个数据的值"><a href="#2、修改某一个数据的值" class="headerlink" title="2、修改某一个数据的值"></a>2、修改某一个数据的值</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> sql = <span class="string">&quot; update 表名 set 字段a = 222 where 字段b = 19&quot;</span>; </span><br><span class="line"><span class="comment">//字段a指的是要修改的数据表头名，数据b为要修改数据对应的改行其他数据表头名，通过字段b对应的数据确定字段a所在的位置。</span></span><br><span class="line">OleDbCommand comm = <span class="keyword">new</span> OleDbCommand(sql, conn);</span><br><span class="line"><span class="comment">//cnn为前面读取的数据表名</span></span><br><span class="line">comm.ExecuteNonQuery();</span><br></pre></td></tr></table></figure><h2 id="3-查找数据表中某一字段中的数据对应的那一行数据"><a href="#3-查找数据表中某一字段中的数据对应的那一行数据" class="headerlink" title="3.查找数据表中某一字段中的数据对应的那一行数据"></a>3.查找数据表中某一字段中的数据对应的那一行数据</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">         OleDbDataAdapter oleDapAdapter; <span class="comment">//检索与填充数据，一般填充SQL语句  </span></span><br><span class="line">         DataSet ds = <span class="keyword">new</span> DataSet();     <span class="comment">//填充ds，保存数据 </span></span><br><span class="line"><span class="built_in">string</span> sql = <span class="string">&quot;select * from 表1 where ID = 18&quot;</span>;</span><br><span class="line"><span class="comment">// select 列名称 from 表名 where 限定的数据表条件</span></span><br><span class="line"><span class="comment">//列名称可用*代替全部；</span></span><br><span class="line">         oleDapAdapter = <span class="keyword">new</span> OleDbDataAdapter(sql, conn);</span><br><span class="line">         oleDapAdapter.Fill(ds);<span class="comment">//将查到的数据放到数据表ds中；</span></span><br><span class="line">         <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; ds.Tables[<span class="number">0</span>].Rows.Count; i++)</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; ds.Tables[<span class="number">0</span>].Columns.Count; j++)</span><br><span class="line">             &#123;</span><br><span class="line">                 MessageBox.Show(ds.Tables[<span class="number">0</span>].Rows[i][j].ToString());<span class="comment">//需要转成String类型  </span></span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         ds.Reset();</span><br></pre></td></tr></table></figure><h2 id="4-在数据库中创建新表"><a href="#4-在数据库中创建新表" class="headerlink" title="4.在数据库中创建新表"></a>4.在数据库中创建新表</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> dbstr = <span class="string">&quot;CREATE TABLE 表2(ID INT,文件夹位置 char(255),文件名字 char(255))&quot;</span>;</span><br><span class="line"><span class="comment">// CREATE TABLE 表名(ID INT,文件夹位置 char(255),文件名字 char(255))</span></span><br><span class="line">            OleDbCommand oleDbCom = <span class="keyword">new</span> OleDbCommand(dbstr, conn);</span><br><span class="line">            oleDbCom.ExecuteNonQuery();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C# </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
            <tag> Acess数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/01/06/hello-world/"/>
      <url>/2023/01/06/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
